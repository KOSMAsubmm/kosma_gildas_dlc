!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!  Plot transition lines over the current spectrum for the current
!  frequency range. Frequencies and species are found in database
!  provided in this file.
!
!  Usage:
!    LAS> @ lines [ypos]
!  where ypos is optionally the y position of the lines to be drawn
!
!  SB & JP, 30-mar-2009
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
! Transition lines catalog. You can add your own transitions but
! do not forget to update astro%line%n later in the code (catalog
! length is not yet automatically detected).
! Column 1: frequencies (GHz)
! Column 2: species (character string)
begin data gag_scratch:molecules.dat
  72.0393124      DCOp-1-0
  72.187704      CCD-1-0
  72.4146936      DCN-1-0
  76.3057270      DNC-1-0
  76.9726897      C3O-8-7
  77.1092581      N2Dp-1-0
  77.6001999      HCOOH-211
  79.511873      C4D-9-8
  79.6430796      C3HD-322
  79.7740945      HCOOH-312
  79.8123180      C3HD-212
  80.48025      CH2CN-404
  80.8321170      H2C2O-404
  81.5862300      H2C2O-413
  81.7778560      C6H-29-28a
  81.8012370      C6H-29-28B
  81.8814677      HC3N-9-8
  82.0935590      c-C3H2-202
  82.6082850      C6Hm-30-29
  82.7404977      HCOOH-413
  82.9662000      c-C3H2-312
  83.065773       c-l-C3H2
  84.4106900      34SO-22
  84.521169       CH3OH-515
  84.5496880      C6H-30-29a
  84.5746000      C6H-30-29a
  84.7276960      c-C3H2-322
  85.0427471      HCOOH-414
  85.139108       OCS-7-6
  85.162159       HC18Op-1-0
  85.3388930      c-C3H2-212
  85.343391      c-C3H2-HCSp
  85.3616498      C6Hm-31-30
  85.455622      CH3CH2-5-4
  85.6433125      C3HD-432
  85.9262780      NH2D-111-o
  86.0549664      HC15N-1-0
  86.09395      SO-22
  86.243350       SIO-V1
  86.3399215      H13CN-1-0
  86.5564989      HCOOH-514
  86.5938345      C3O-9-8
  86.6707600      HCO-1
  86.7083600      HCO-2
  86.7542884      H13COp-1-0
  86.777460      HCO-3
  86.8057800      HCO-4
  86.846891       SIO-2-1
  87.0908500      HN13C-1-0
  87.0575347       HC17Op-1-0
  87.3169250      CCH-1
  87.3215040      C6H-31-30a
  87.3286240      CCH-2
  87.3479940      C6H-31-30b
  87.4020040      CCH-3
  87.4071650      CCH-4
  87.6946938      HCOOH-404
  87.9252520      HNCO-404
  88.1149905      C6Hm-32-31
  88.3440000      C4D-10-9
  88.6304156      HCN-1-0-1
  88.6318475      HCN-1-0-2
  88.6339357      HCN-1-0-3
  88.8657150      H15NC-1-0
  89.188523       HCOp-1-0
  89.4874140      HOCp-1-0
  90.0932950      C6H-32-31a
  90.1214070      C6H-32-31b
  90.2638330      15NNHp-1-0
  90.6610970      HCOOH-413
  90.6635680      HNC-1-0
  90.8683064      C6Hm-33-32
  90.938090      CH3OCH3-606
  90.9789933      HC3N-10-9
  91.2057411      N15NHp-1-0
  91.2462251      D2CO-514-515
  91.2915604      HCOOH-615
  91.9870540      CH3CN-5-4
  92.2278530      CCO-45
  92.3632860      CCO-44
  92.7188000      CCO-43
  93.176258      N2Hp-1-0
  93.5808590      CH3CHO-a-515
  95.1503971      C4H-10-9
  95.914309      CH3OH-212
  95.9633800      CH3CHO-a-505
  96.2148127      C3O-10-9
  96.2742000      CH3CHO-a-524
  96.412982       C34S-2-1
  96.6325500      CH3CHO-a-523
  96.741375      CH3OH-202-101
  96.7434467      HCOOH-111-000
  96.7817600      34SO-54
  97.1759280      C4D-11-10
  97.3012085      OCS-8-7
  97.7153170      34SO-23
  97.980968       CS-2-1
  98.9009860      CH3CHO-a-514
  99.2998700      SO-23
  100.076392      HC3N-11-10
  100.0945140      H2C2O-515
  100.59834      CH2CN-505
  101.0366300      H2C2O-505
  101.8924167      CH3CHO-a-313
  101.9814290      H2C2O-514
  102.031906      34SO2
  102.4230091      C3HD-413
  102.5460241      CH3CCH-6-5
  102.587484      CFp-1-0
  104.1871076      C3HD-303
  104.711385      13C18O-1-0
  105.8356009      C3O-11-10
  106.0076820      C4D-12-11
  106.2560998      C3HD-423
  106.2665926      HCOOH-515
  106.7432440      34SO-32
  107.013803      CH3OH-313
  107.4236531      C3HD-313
  108.6369230      13CN-1-0-1
  108.6512970      13CN-1-0-2
  108.7802010      13CN-1-0-3
  108.893963      CH3OH-000
  109.1736340      HC3N-12-11
  109.2522200      SO-32
  109.4707106      HCOOH-505-404
  109.7821734     C18O-1-0
  109.9057580     HNCO-505
  110.0245900      C15N-1-0
  110.1535940      NH2D-111-p
  110.2013543      13CO-1-0
  110.3834940      CH3CN-6-5
  110.8378300      D2CO-212
  112.2487200      CH3CHO-a-616
  112.2647662      CNm-1-0
  112.359277      C17O-1-0
  113.1233701     CN-1-0-1
  113.1441573     CN-1-0-2
  113.1704915     CN-1-0-3
  113.1912787     CN-1-0-4
  113.2867118      HCCO-514
  113.326500      CNZ-1-0
  113.4881202     CN-1-0-5
  113.4909702     CN-1-0-6
  113.4996443     CN-1-0-7
  113.5089074     CN-1-0-8
  113.5204315     CN-1-0-9
  114.8392296      C4D-13-12
  114.9596500      CH3CHO-a-606
  115.271204      12CO-1-0
  115.3540350      CCO-56
  115.4530240      CCO-55
  115.4561746      C3O-12-11
  115.4939000      CH3CHO-a-625
  115.6565660      CCO-54
  115.8044050      SOp-3-2a
  116.1799470      SOp-3-2b
  117.6923733      COp-1a
  118.1017908      COp-1b
  127.3676660      HC3N-14-13
  128.7794040      CH3CN-7-6
  128.8128600      HDCO-202
  129.1389230      SO-33
  130.8918386      CH3CHO-a-717
  131.1498866      HCOOH-606-505
  132.890692      CH3OH-616
  133.605500      CH3OH-524
  133.8540400      CH3CHO-a-707
  134.2848300      HDCO-211
  134.6965791      C3O-14-13
  135.6409000      C3HD-404
  135.7757280      34SO-34
  135.8849481      HCOOH-615
  136.3709100      C3HD-414
  136.464400      HC3N-15-14
  136.5048069      CH3CHO-e-422
  136.4644109      HC3N-15-14
  136.7253966      CH3C2H-8-7
  137.1847188      HCOOH-313
  137.4544640      C3HD-220
  138.1786000      SO-34
  138.3196155      CH3CHO-a-716
  138.4648580      CCO-67
  138.4783953      CH3CHO-e-321
  138.5420920      CCO-66
  138.6775860      CCO-65
  139.9439485      CH3CHO-e-220
  140.1274740      H2C2O-717
  140.8395020      H2CO-212
  141.1299796      CH3CHO-e-221
  141.4380670      H2C2O-717
  141.9837404     H213CO-202
  142.34900      D13CN-2-1
  142.6937007      CH3CHO-e-322
  143.865801      CH3OH-313
  144.0772890      DCOp-2-1
  144.241935      CCD-2-1
  144.617147      C34S-3-2
  144.8280015      DCN-2-1
  144.8961104      CH3CHO-e-423
  144.918836      CH3OH-2-1
  144.9434670      HC13CCN
  145.0895946      c-C3H2-312-221
  145.093707      CH3OH-303
  145.097370      CH3OH-3-13
  145.103152      CH3OH-303-2
  145.124410      CH3OH-322
  145.126190      CH3OH-321
  145.126392      CH3OH-3-22
  145.131855      CH3OH-312-2
  145.133460      CH3OH-321
  145.5609596      HC3N-16-15
  145.602949      H2CO-146
  146.368342      CH3OH-312-0
  146.734002      DN13C-2-1
  146.969049      CS-3-2
  147.1733471      CH3CN-8-7
  147.7265356      CH3CHO-e-524
  148.6396025      HCOOH-717
  148.8423490      C3HD-322
  150.1764800      NO-1-2
  150.4365448      c-C3H2-220
  150.4983340      H2CO-211
  150.5465200      NO-3-2
  150.8206650      c-C3H2-404
  150.8519080      c-C3H2-414
  151.3438730      c-C3H2-514
  151.3611005      c-C3H2-524
  152.6097740      DNC-2-1
  152.7154803      HCOOH-707
  153.8142732      CH3CCH-9-8
  154.2170318      N2Dp-2-1
  154.382146      NH2D-211
  154.4147700      HNCO-716
  154425.7800      CH3OH-11-0-11
  154.6572840      HC3N-17-16
  155.5182951      c-C3H2-322
  155.5067950      34SO-43
  156.3872677      HCOOH-414
  156.602413      CH3OH-212
  157.246056      CH3OH-404
  157.270851      CH3OH-101
  157.272369      CH3OH-303-3
  157.276058      CH3OH-202
  158.4208191      C3HD-413
  158.4493839      HCOOH-716
  158.9718112      SO-43
  161.6340730      H2C2O-808
  161.5671260      CCO-78
  161.6303060      CCO-77
  161.7294330      CCO-76
  162.3713483      C3HD-330
  162.1985980      SOp-4-3a
  162.5740580      SOp-4-3b
  163.7533890      HC3N-18-17
  165.050195      CH3OH-110
  165.061156      CH3OH-211
  165.099271      CH3OH-312
  165.190530      CH3OH-413
  165.5689500      CH3CN-9-8
  166.1027475      D2CO-313
  168.577860      CH3OH-413-2
  168.762762      H2S-110-101
  168.8151350      34SO-44
  169.7816293      HCOOH-818
  170.9025157      CH3CCH-10-9
  172.0793700      CH3OH-11-56
  172.1079570      HC15N-2-1
  172.1814034      SO-44
  172.6778513      H13CN-2-1
  172.8493000      HC3N-19-18
  173.377377      HCO-20-1
  173.4060816      HCO-20-2
  173.4430648      HCO-20-3
  173.5066953      H13COp-2-1
  173.688207      SiO-4-3
  173.7120598      HCO-21-1
  174.1533650      HCOOH-808
  174.1794080      HN13C-2-1
  174.4131183      D2CO-303
  174.6632220      CCH-2-1
  174.6676850      CCH-2-2
  174.7217770      CCH-2-3
  174.7280740      CCH-2-4
  174.9591665      HCOOH-515
  175.3527660      34SO-45
  175.3860690      D2CO-322
  176.3739030      D2CO-321
  177.261167      HCN-2-1
  177.7290940      H15NC-2-1
  178.375065      HCOP-2-1
  178.6054030      SO-45
  178.9720510      HOCp-2-1
  180.5256690      15NNHp-2-1
  181.3247580      HNC-2-1
  186.344771      N2Hp-2-1
  195.5589200      HDS-110
  200.1353920      HC3N-22-21
  200.2946300      C3HD-330
  201.3413620      HDCO-312
  201.8464800      34SO-54
  202.3556100      CH3CN-11-10
  204.7889260      c-C3H2-422
  205.0767750      CH3CCH-12-11
  205.1704490      CFp-2-1
  205.791270      CH3OH-205
  206.1316260     H213CO-313
  206.1760050      SO-54
  207.7569750      CCO-910
  207.8037069      CCO-99
  207.8670678      CCO-98
  208.5900163      SOp-5-4a
  208.9654203      SOp-5-4b
  209.2302340      HC3N-23-22
  210.4449851      HCOOH-717
  210.7603446      C3HD-321
  211.0130300      34SO-55
  211.2114680      H2CO-313
  213.427118      CH3OH-110
  215.2206530      SO-55
  215.8399200      34SO-56
  216.1125822      DCOp-3-2
  216.2787560      c-C3H2-330
  216.3728300      CCD-3-2
  216.6254124      HCOOH-523
  217.0742390      13CN-2-1-1
  217.1049800      SiO-5-4
  217.2385378      DCN-3-2
  217.2776800      13CN-2-1-2
  217.2992020      CH3OH-615
  217.3031910      13CN-2-1-3
  217.4285632      13CN-2-1-4
  217.4671500      13CN-2-1-5
  217.5600290      c-C3H2-606
  217.802281041   unknown-3
  217.8221480      c-C3H2-616
  217.9400460      c-C3H2-514
  218.1604423      c-C3H2-524
  218.222190      H2CO-218
  218.3247230      HC3N-24-23
  218.440050      CH3OH-422
  218.4756320      H2CO-322
  218.7600660      H2CO-321
  219.5603541     C18O-2-1
  219.7087429      C15N-2
  219.7001197      HCOOH-422
  219.7983200      HNCO-10-9
  219.9348200      C15N-2-1-1
  219.9494420      SO-56
  220.097238      DN13C-3-2
  220.3986842     13CO-2-1
  220.747263      CH3CN-12-11
  221.1916648      D2CO-414
  221.6970660      C3HD-432
  222.1494587      CH3CHO-e-422
  222.166970      CH3CCH-13-12
  222.2877514      HCOOH-321
  224.3030962      HCOOH-220
  224.5250608      CNm-2-1
  224.714370      C17O-2-1
  225.5548226      CH2NH
  225.697772      H2CO225
  226.8741908     CN-2-1-1
  226.8747813     CN-2-1-2
  226.8758960     CN-2-1-3
  226.8874202     CN-2-1-4
  226.8921280     CN-2-1-5
  227.1691272      c-C3H2-432
  227.4189050      HC3N-25-24
  228.4984585      HCOOH-221
  228.9104890      DNC-3-2
  230.027060      CH3OH-3-22
  230.537990      12CO-2-1
  230.6192949      HCOOH-322
  230.8469163      CCO-1011
  230.8885837      CCO-1010
  230.9423657      CCO-109
  231.2209960      13CS-5-4
  231.2811000      CH3OH-1029
  231.3218566      N2Dp-3-2
  231.4102340      D2CO-404
  232.6443270      CH3D
  233.4541544      HCOOH-423
  233.6504410      D2CO-423
  234.0930624      CH3CHO-e-532
  234.2008179      CH3CHO-e-431
  234.2444701      CH3CHO-e-330
  234.3936407      CH3CHO-e-533
  234.4340660      CH3CHO-e-432
  234.464629      CH3CHO-e-331
  235.7896410      COp-2a
  236.0625530      COp-2b
  236.1020860      D2CO-422
  236.5127888      HC3N-26-25
  237.0085966      HCOOH-524
  238.3831584       NOp-2-1
  239.1379312      CH3CN-13-12
  239.746253      CH3OH-515
  239.2477272      CH3CCH-14-13
  241.016176      C34S-5-4
  241.700219      CH3OH-505
  241.767224      CH3OH-5-15
  241.791431      CH3OH-505-4
  244.2221334      c-C3H2-321
  244.5555800      HDS-101
  244.935606      CS-5-4
  245.5327520      D2CO-413
  245.6063199      HC3N-27-26
  246.6634700      34SO-65
  249.0543680      c-C3H2-523
  250.4754140       NO-2-5
  250.5069800      CH3OH-110
  250.6352070      CH3OH-123
  250.7082450      NO-7-2
  251.3143433      c-C3H2-717
  251.5086912      c-C3H2-615
  251.5273023      c-C3H2-625
  251.8257700      SO-65
  253.2070172      34SO-66
  254.9779350      SOp-6-5a
  255.3532370      SOp-6-5b
  255.480281      HC18Op-3-2
  256.3317358      CH3CCH-15-14
  256.5855380      HDCO-404
  256.8778090      34SO-67
  257.5273984      CH3CN-14-13
  258.1569964      HC15N-3-2
  258.2558259      SO-66
  258.983416858   unknown-1
  259.000613425   unknown-2
  259.0117978      H13CN-3-2
  260.0603290      HCO-30-1
  260.0821920      HCO-30-2
  260.1335860      HCO-30-3
  260.1557690      HCO-30-4
  260.2553390      h13COp-3-2
  260.4797460      c-C3H2-532
  260.518077      SiO-6-5
  261.2633101      HN13C-3-2
  261.8437210      SO-67
  262.0042600      CCH-3-1
  262.0064820      CCH-3-2
  262.0649860      CCH-3-3
  262.0674690      CCH-3-4
  265.886432      HCN-3-2
  266.5878003      H15NC-3-2
  267.557625      HCOp-3-2
  268.4510940      HOCp-3-2
  269.6348278      HCOOH-221
  270.7835111      15NNHp-3-2
  271.0594543      HCOOH-220
  271.9811420     HNC-3-2
  273.6091384      N15NHp-3-2
  279.5117010      N2Hp-3-2
end data gag_scratch:molecules.dat

begin data gag_scratch:molecules3mm.dat
  83.688          SO2
  84.534          CH
  86.09395        SO-22
  86.243350       SIO-V1
  86.846891       SIO-2-1
  88.6304156      HCN-1-0-1
  89.188523       HCOp-1-0
  90.6635680      HNC-1-0
  97.980968       CS-2-1
  99.2998700      SO-23
  100.076392      HC3N-11-10
  104.1871076      C3HD-303
  104.1871076      C3HD-303
  104.711385      13C18O-1-0
  106.7432440      34SO-32
  107.013803      CH3OH-313
  109.2522200      SO-32
  109.7821734     C18O-1-0
  110.2013543      13CO-1-0
  112.359277      C17O-1-0
  113.4881202     CN-1-0-5
  115.271204      12CO-1-0
  115.8044050      SOp-3-2a
end data gag_scratch:molecules3mm.dat
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
if (.not.exist(rx)) then
  message e lines "No spectrum in memory"
  return
end if
!
define structure astro
define structure astro%line
define integer   astro%line%n
let astro%line%n 453   ! Update number of lines in catalog here
!let astro%line%n 22   ! Update number of lines in catalog here
define double    astro%line%freq[astro%line%n]  ! GHz
define character astro%line%name*20[astro%line%n]
accept astro%line%freq astro%line%name /column atm_lines.dat
!
define structure frange
define double frange%corr[2] frange%rest[2]
set unit f  !  Must get frequencies in RX
!plot          !  Replot for safety because current X axis is in previous units.
if (freq_step.gt.0.0) then
    let frange%corr rx[1] rx[channels]  ! MHz
else
    let frange%corr rx[channels] rx[1]  ! MHz
endif
let frange%rest (frange%corr+frequency)/1000  ! GHz
!
define real yrange ypos
let yrange user_ymax-user_ymin
if (pro%narg.eq.1) then
  let ypos 'pro%arg[1]'
else
  let ypos user_ymin+yrange*.7
endif
!
pen 1
set expand .8
for ifreq 1 to astro%line%n
  if astro%line%freq[ifreq].gt.frange%rest[1].and.astro%line%freq[ifreq].lt.frange%rest[2] then
     say 'astro%line%freq[ifreq]*1000' 'astro%line%name[ifreq]'
     g\draw relo 'astro%line%freq[ifreq]*1000-frequency' ypos /user
     g\draw line 'astro%line%freq[ifreq]*1000-frequency' ypos+yrange/10 /user
     g\draw text 'astro%line%freq[ifreq]*1000-frequency' ypos+yrange/10 'astro%line%name[ifreq]' 6 90 /user
     ! ana\draw molecule astro%line%freq[ifreq]*1000 'astro%line%name[ifreq]'
  end if
next ifreq
pen 0
set expand 1.0
!
! Clean
sic delete gag_scratch:molecules.dat
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
